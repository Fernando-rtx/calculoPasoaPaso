<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cálculo Paso a Paso - UES FMOcc</title>
    <style>
        /* --- Estilos Generales --- */
        :root {
            --color-primario: #660300; /* Azul UES institucional */
            --color-secundario: #f4f4f4;
            --color-texto: #333;
            --color-blanco: #ffffff;
            --sombra-caja: 0 4px 8px rgba(0,0,0,0.1);
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            background-color: var(--color-secundario);
            color: var(--color-texto);
            line-height: 1.6;
        }

        /* --- Encabezado --- */
        header {
            background-color: var(--color-primario);
            color: var(--color-blanco);
            padding: 2rem 1rem;
            text-align: center;
            border-bottom: 5px solid #d4a404; /* Detalle dorado/amarillo */
        }

        header h1 {
            margin: 0;
            font-size: 2.5rem;
        }

        header p {
            max-width: 800px;
            margin: 1rem auto 0;
            font-size: 1.1rem;
        }

        /* --- Contenedor Principal --- */
        main {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 1rem;
        }

        /* --- Secciones --- */
        section {
            background-color: var(--color-blanco);
            padding: 2rem;
            margin-bottom: 2rem;
            border-radius: 8px;
            box-shadow: var(--sombra-caja);
        }

        h2 {
            color: var(--color-primario);
            border-bottom: 2px solid var(--color-secundario);
            padding-bottom: 0.5rem;
            margin-top: 0;
        }

        /* --- Sección de Descargas --- */
        .guias-container {
            display: flex;
            flex-wrap: wrap;
            gap: 2rem;
            justify-content: center;
        }

        .guia-card {
            background-color: #fdfdfd;
            border: 1px solid #eee;
            border-radius: 8px;
            padding: 1.5rem;
            width: 300px;
            text-align: center;
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .guia-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0,0,0,0.15);
        }

        .guia-card h3 {
            margin-top: 0;
            color: var(--color-primario);
        }

        .btn {
            display: inline-block;
            background-color: var(--color-primario);
            color: var(--color-blanco);
            padding: 0.8rem 1.5rem;
            margin-top: 1rem;
            text-decoration: none;
            border-radius: 5px;
            font-weight: bold;
            transition: background-color 0.3s;
        }
        
        .btn.resuelto {
            background-color: #28a745; /* Verde para los resueltos */
        }

        .btn:hover {
            opacity: 0.9;
        }

        /* --- Sección Paso a Paso --- */
        .selector-container {
            display: flex;
            gap: 1rem;
            align-items: center;
            flex-wrap: wrap;
            margin-bottom: 2rem;
        }

        .selector-container label {
            font-weight: bold;
        }

        .selector-container select,
        .selector-container input,
        .selector-container button {
            padding: 0.7rem;
            border-radius: 5px;
            border: 1px solid #ccc;
            font-size: 1rem;
        }
        
        .selector-container button {
            background-color: #d4a404;
            color: var(--color-primario);
            cursor: pointer;
            border: none;
            font-weight: bold;
        }

        #solucion-container {
            margin-top: 2rem;
            padding: 1.5rem;
            background-color: #f9f9f9;
            border: 1px dashed #ccc;
            border-radius: 5px;
            min-height: 100px;
        }
        
        /* --- Pie de Página --- */
        footer {
            text-align: center;
            padding: 1.5rem;
            background-color: #343a40;
            color: var(--color-blanco);
            margin-top: 2rem;
        }
        /* --- Estilos para el Footer (añadir esto) --- */
        footer img {
            width: 60px; /* Ajusta el tamaño del logo como prefieras */
            margin-bottom: 0.5rem;
            filter: brightness(0) invert(1); /* Pone el logo en blanco para que combine */
        }

        footer p {
            margin: 0;
        }
    </style>
</head>
<body>

    <header>
        <h1>Cálculo Diferencial Paso a Paso</h1>
        <p>
            ¡Bienvenido! Soy <strong>Fernando Guevara</strong>, estudiante de la Facultad Multidisciplinaria de Occidente de la UES.
            He creado este espacio como un recurso de apoyo para mis compañeros y docentes. Aquí encontrarás las guías de ejercicios de Cálculo Diferencial,
            sus versiones resueltas y una herramienta para ver las soluciones detalladas.
        </p>
    </header>

    <main>
        <section id="descargas">
            <h2>Descarga de Guías en PDF</h2>
            <div class="guias-container">
                
                <div class="guia-card">
                    <h3>Guía de Ejercicios #1</h3>
                    <p>Temas introductorios sobre funciones, límites y continuidad, la base para entender la derivada.</p>
                    <a href="GuiasDescargables/guia-1-ejercicios.pdf" download class="btn">Descargar Ejercicios</a>
                    <a href="GuiasDescargables/guia-1-resuelta.pdf" download class="btn resuelto">Descargar Resuelta</a>
                </div>
                
                <div class="guia-card">
                    <h3>Guía de Ejercicios #2</h3>
                    <p>Ejercicios sobre la definición de la derivada utilizando límites y el concepto de la recta tangente.</p>
                    <a href="GuiasDescargables/guia-2-ejercicios.pdf" download class="btn">Descargar Ejercicios</a>
                    <a href="GuiasDescargables/guia-2-resuelta.pdf" download class="btn resuelto">Descargar Resuelta</a>
                </div>

                <div class="guia-card">
                    <h3>Guía de Ejercicios #3</h3>
                    <p>Aplicación de las reglas básicas de derivación: regla de la potencia, suma, resta y múltiplo constante.</p>
                    <a href="GuiasDescargables/guia-3-ejercicios.pdf" download class="btn">Descargar Ejercicios</a>
                    <a href="GuiasDescargables/guia-3-resuelta.pdf" download class="btn resuelto">Descargar Resuelta</a>
                </div>
                
                <div class="guia-card">
                    <h3>Guía de Ejercicios #4</h3>
                    <p>Práctica de las reglas de derivación para productos y cocientes de funciones (Reglas del Producto y Cociente).</p>
                    <a href="GuiasDescargables/guia-4-ejercicios.pdf" download class="btn">Descargar Ejercicios</a>
                    <a href="GuiasDescargables/guia-4-resuelta.pdf" download class="btn resuelto">Descargar Resuelta</a>
                </div>

                <div class="guia-card">
                    <h3>Guía de Ejercicios #5</h3>
                    <p>Ejercicios enfocados en las derivadas de las funciones trigonométricas básicas (seno, coseno, tangente, etc.).</p>
                    <a href="GuiasDescargables/guia-5-ejercicios.pdf" download class="btn">Descargar Ejercicios</a>
                    <a href="GuiasDescargables/guia-5-resuelta.pdf" download class="btn resuelto">Descargar Resuelta</a>
                </div>

                <div class="guia-card">
                    <h3>Guía de Ejercicios #6</h3>
                    <p>Problemas sobre la Regla de la Cadena y derivadas de funciones exponenciales y logarítmicas.</p>
                    <a href="GuiasDescargables/guia-6-ejercicios.pdf" download class="btn">Descargar Ejercicios</a>
                    <a href="GuiasDescargables/guia-6-resuelta.pdf" download class="btn resuelto">Descargar Resuelta</a>
                </div>

                <div class="guia-card">
                    <h3>Guía de Ejercicios #7</h3>
                    <p>Problemas de derivadas de orden superior (segunda, tercera derivada, etc.) y diferenciación implícita.</p>
                    <a href="GuiasDescargables/guia-7-ejercicios.pdf" download class="btn">Descargar Ejercicios</a>
                    <a href="GuiasDescargables/guia-7-resuelta.pdf" download class="btn resuelto">Descargar Resuelta</a>
                </div>

            </div>
        </section>

        <section id="paso-a-paso">
            <h2>Ejercicios Resueltos de las Guías</h2>
            <p>Selecciona la guía, la sección (A, B, C...) y el número del ejercicio que deseas consultar. La solución detallada aparecerá abajo.</p>
            
            <div class="selector-container">
                <label for="guia-select">Guía:</label>
                <select id="guia-select">
                    <option value="1">Guía 1: Funciones y Límites</option>
                    <option value="2">Guía 2: Funciones Exponenciales y Logarítmicas</option>
                    <option value="3">Guía 3: Trigonometría</option>
                    <option value="4">Guía 4: Límites (Continuación)</option>
                    <option value="5">Guía 5: La Derivada y Reglas Básicas</option>
                    <option value="6">Guía 6: Regla de la Cadena</option>
                    <option value="7">Guía 7: Derivadas de Orden Superior</option>
                </select>

                <label for="seccion-select">Sección:</label>
                <select id="seccion-select">
                    <option value="a">Sección A</option>
                    <option value="b">Sección B</option>
                    <option value="c">Sección C</option>
                    <option value="d">Sección D</option>
                    <option value="e">Sección E</option>
                    <option value="f">Sección F</option>
                    <option value="g">Sección G</option>
                    <option value="h">Sección H</option>
                    <option value="i">Sección I</option>
                    <option value="j">Sección J</option>
                </select>

                <label for="ejercicio-input">Ejercicio #:</label>
                <input type="number" id="ejercicio-input" placeholder="Ej: 5" min="1">

                <button onclick="mostrarSolucion()">Ver Solución</button>
            </div>

            <div id="solucion-container">
                <p>Esperando selección...</p>
            </div>
        </section>
        <section id="calculadora-wolfram">
            <h2>Calculadora con Wolfram|Alpha</h2>
            <p>Escribe cualquier problema de cálculo (en inglés, preferiblemente) para obtener una solución detallada. Por ejemplo: "derivative of f(x)= x^4 * sin(x)".</p>
            
            <div class="selector-container">
                <label for="problemaMatematico">Problema:</label>
                <input type.text" id="problemaMatematico" placeholder="Escribe tu problema aquí..." style="flex-grow: 1;">

                <button id="resolverBtn">Resolver</button>
            </div>

            <div id="solucion" style="margin-top: 2rem; padding: 1.5rem; background-color: #f9f9f9; border: 1px dashed #ccc; border-radius: 5px; min-height: 100px;">
                <p>Esperando un problema para resolver...</p>
            </div>
        </section>
    </main>

    <footer>
        <img src="fotos/logoMinerva.png" alt="Logo Minerva UES">
        <p>Proyecto desarrollado por Fernando Guevara para la comunidad de la UES-FMOcc. ¡Éxitos en sus estudios!!</p>
    </footer>

    <script>
    // --- ESTRUCTURA DE DATOS PARA LAS SOLUCIONES DE LAS GUÍAS ---
    // Ahora está organizada por Guía, luego por Sección (a, b, c...), y finalmente por número de ejercicio.

    const soluciones = {
        "1": { // Guía 1
    "a": { // Sección A
        "1": `<h3>Solución: Guía 1, Sección A, Ejercicio 1</h3>
              <p><strong>Función dada:</strong> f(x) = x² - 1</p>
              <p>A continuación, se evalúa la función para cada uno de los valores solicitados:</p>
              <hr>
              
              <p><strong>1. Calcular f(-√3):</strong></p>
              <p>Se sustituye x por -√3:</p>
              <p>f(-√3) = (-√3)² - 1</p>
              <p>f(-√3) = 3 - 1 = <strong>2</strong></p>
              
              <p><strong>2. Calcular f(3):</strong></p>
              <p>Se sustituye x por 3:</p>
              <p>f(3) = (3)² - 1</p>
              <p>f(3) = 9 - 1 = <strong>8</strong></p>
              
              <p><strong>3. Calcular f(6):</strong></p>
              <p>Se sustituye x por 6:</p>
              <p>f(6) = (6)² - 1</p>
              <p>f(6) = 36 - 1 = <strong>35</strong></p>

              <p><strong>4. Calcular f(a):</strong></p>
              <p>Se sustituye x por 'a':</p>
              <p>f(a) = (a)² - 1 = <strong>a² - 1</strong></p>

              <p><strong>5. Calcular f(-a):</strong></p>
              <p>Se sustituye x por '-a':</p>
              <p>f(-a) = (-a)² - 1 = <strong>a² - 1</strong></p>

              <p><strong>6. Calcular f(a+b):</strong></p>
              <p>Se sustituye x por '(a+b)':</p>
              <p>f(a+b) = (a+b)² - 1</p>
              <p>f(a+b) = <strong>a² + 2ab + b² - 1</strong></p>

              <p><strong>7. Calcular f(-5):</strong></p>
              <p>Se sustituye x por -5:</p>
              <p>f(-5) = (-5)² - 1</p>
              <p>f(-5) = 25 - 1 = <strong>24</strong></p>
              `
    }
            // ... aquí irían las demás secciones y ejercicios de la Guía 1
        },
        "5": { // Guía 5
            "b": { // Sección B
                "1": `<h3>Solución: Guía 5, Sección B, Ejercicio 1</h3>
                      <p><strong>Función:</strong> f(x) = 20</p>
                      <p><strong>Derivada por definición:</strong> f'(x) = lim(h→0) [f(x+h) - f(x)] / h</p>
                      <p>f'(x) = lim(h→0) [20 - 20] / h = lim(h→0) 0 / h = 0</p>
                      <p><strong>Resultado:</strong> f'(x) = 0</p>`
            }
        },
        "6": { // Guía 6
            "a": { // Sección A
                "1": `<h3>Solución: Guía 6, Sección A, Ejercicio 1</h3>
                      <p><strong>Función:</strong> f(x) = (3x+1)⁴</p>
                      <p><strong>Regla de la Cadena:</strong> f'(x) = n * u^(n-1) * u'</p>
                      <p>u = 3x+1, u' = 3, n = 4</p>
                      <p><strong>Resultado:</strong> f'(x) = 4 * (3x+1)³ * 3 = 12(3x+1)³</p>`
            }
        }
        // ... y así sucesivamente con las demás guías y secciones
    };

    function mostrarSolucion() {
        const guiaSeleccionada = document.getElementById('guia-select').value;
        const seccionSeleccionada = document.getElementById('seccion-select').value; // 'a', 'b', 'c'...
        const ejercicioSeleccionado = document.getElementById('ejercicio-input').value;
        const contenedor = document.getElementById('solucion-container');

        if (!ejercicioSeleccionado) {
            contenedor.innerHTML = "<p style='color: red;'>Por favor, introduce un número de ejercicio.</p>";
            return;
        }

        // --- LÓGICA DE BÚSQUEDA ACTUALIZADA ---
        let solucionHTML;
        if (soluciones[guiaSeleccionada] && 
            soluciones[guiaSeleccionada][seccionSeleccionada] && 
            soluciones[guiaSeleccionada][seccionSeleccionada][ejercicioSeleccionado]) {
            
            solucionHTML = soluciones[guiaSeleccionada][seccionSeleccionada][ejercicioSeleccionado];
        }

        // --- MENSAJE DE RESPUESTA ACTUALIZADO ---
        if (solucionHTML) {
            contenedor.innerHTML = solucionHTML;
        } else {
            contenedor.innerHTML = `<p>Lo sentimos, la solución para el ejercicio <strong>#${ejercicioSeleccionado}</strong> 
                                     de la <strong>Sección ${seccionSeleccionada.toUpperCase()}</strong> 
                                     de la <strong>Guía ${guiaSeleccionada}</strong> no está disponible.</p>`;
        }
    }
</script>
<script>
    const resolverBtn = document.getElementById('resolverBtn');
    const problemaInput = document.getElementById('problemaMatematico');
    const solucionDiv = document.getElementById('solucion');

    resolverBtn.addEventListener('click', async () => {
        const problema = problemaInput.value;
        if (!problema) {
            solucionDiv.innerHTML = "<p>Por favor, escribe un problema.</p>";
            return;
        }

        solucionDiv.innerHTML = '<p>Consultando a Wolfram|Alpha...</p>';

        try {
            const response = await fetch('/api/resolver', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ problema: problema })
            });

            if (!response.ok) {
                throw new Error(`Error de comunicación con el servidor: ${response.statusText}`);
            }

            const data = await response.json();

            // --- LÓGICA DE PROCESAMIENTO MEJORADA ---

            // 1. Revisamos primero si Wolfram|Alpha nos devolvió un error explícito.
            if (data.queryresult.error) {
                // Mostramos el mensaje de error que nos da la API
                solucionDiv.innerHTML = `<p style="color: red;"><strong>Error de Wolfram|Alpha:</strong> ${data.queryresult.error.msg || 'No se pudo procesar la consulta.'}</p>`;
                return;
            }

            // 2. Revisamos si la consulta no fue exitosa o no tiene "pods" (bloques de resultado)
            if (!data.queryresult.success || !data.queryresult.pods || data.queryresult.pods.length === 0) {
                solucionDiv.innerHTML = `<p>Wolfram|Alpha no pudo encontrar una respuesta para esta consulta.</p>`;
                return;
            }

            // 3. Si todo lo anterior pasó, procesamos y mostramos la solución.
            const pods = data.queryresult.pods;
            let solucionHtml = '<h3>No se encontró una solución paso a paso.</h3>';

            const pasoAPaso = pods.find(pod => pod.id === 'Step-by-step solution');
            const resultadoFinal = pods.find(pod => pod.id === 'Result');

            if (pasoAPaso && pasoAPaso.subpods.length > 0) {
                solucionHtml = `<h2>Solución Paso a Paso:</h2>`;
                pasoAPaso.subpods.forEach(subpod => {
                    solucionHtml += `<p>${subpod.plaintext}</p>`;
                    if (subpod.img && subpod.img.src) {
                        solucionHtml += `<img src="${subpod.img.src}" alt="Paso matemático" style="max-width: 100%; height: auto; border: 1px solid #ccc; margin-top: 10px;">`;
                    }
                });
            } else if (resultadoFinal) {
                 solucionHtml = `<h2>Resultado:</h2><p>${resultadoFinal.subpods[0].plaintext}</p>`;
                 if (resultadoFinal.subpods[0].img && resultadoFinal.subpods[0].img.src) {
                    solucionHtml += `<img src="${resultadoFinal.subpods[0].img.src}" alt="Resultado matemático" style="max-width: 100%; height: auto; border: 1px solid #ccc; margin-top: 10px;">`;
                 }
            }

            solucionDiv.innerHTML = solucionHtml;

        } catch (error) {
            console.error('Error en el script:', error);
            solucionDiv.innerHTML = `<p style="color: red;">Hubo un error crítico al procesar tu petición. Revisa la consola del navegador para más detalles.</p>`;
        }
    });
</script>
</body>
</html>